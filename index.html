<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title></title>

    <!--Import of bootstrap-->
    <link href="css/bootstrap.min.css" rel="stylesheet" />

    <!--Import of React Bootstrap-->
    <link rel="stylesheet"
          href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css"
          integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3"
          crossorigin="anonymous" />

    <!--Script to import ether js-->
    <script src="https://cdn.ethers.io/lib/ethers-5.2.umd.min.js"
            type="application/javascript"></script>

    <style>
        * {
            margin: 0;
            padding: 0;
        }

        .imgbox {
            display: grid;
            height: 100%;
        }

        .center-fit {
            max-width: 100%;
            max-height: 100%;
            margin: auto;
        }
    </style>

</head>
<body class="container" style="background-color:#266d85">

    <script>
        window.onload = function () {
            getvotes();
        }

        function getvotes() {

            //Contract Address from Deploy Screen Remix -- Change to your contract
            const daiAddress = "0x146cEaa0a2d5c8ee542AAa3E97e0386C38353664";

            //ABI from Compile Screen RemixIDE
            abi = [
                {
                    "inputs": [
                        {
                            "internalType": "address",
                            "name": "to",
                            "type": "address"
                        }
                    ],
                    "name": "delegate",
                    "outputs": [],
                    "stateMutability": "nonpayable",
                    "type": "function"
                },
                {
                    "inputs": [
                        {
                            "internalType": "address",
                            "name": "voter",
                            "type": "address"
                        }
                    ],
                    "name": "giveRightToVote",
                    "outputs": [],
                    "stateMutability": "nonpayable",
                    "type": "function"
                },
                {
                    "inputs": [],
                    "stateMutability": "nonpayable",
                    "type": "constructor"
                },
                {
                    "inputs": [
                        {
                            "internalType": "uint256",
                            "name": "proposal",
                            "type": "uint256"
                        }
                    ],
                    "name": "vote",
                    "outputs": [],
                    "stateMutability": "nonpayable",
                    "type": "function"
                },
                {
                    "inputs": [],
                    "name": "chairperson",
                    "outputs": [
                        {
                            "internalType": "address",
                            "name": "",
                            "type": "address"
                        }
                    ],
                    "stateMutability": "view",
                    "type": "function"
                },
                {
                    "inputs": [
                        {
                            "internalType": "uint256",
                            "name": "",
                            "type": "uint256"
                        }
                    ],
                    "name": "proposals",
                    "outputs": [
                        {
                            "internalType": "string",
                            "name": "name",
                            "type": "string"
                        },
                        {
                            "internalType": "uint256",
                            "name": "voteCount",
                            "type": "uint256"
                        }
                    ],
                    "stateMutability": "view",
                    "type": "function"
                },
                {
                    "inputs": [
                        {
                            "internalType": "address",
                            "name": "",
                            "type": "address"
                        }
                    ],
                    "name": "voters",
                    "outputs": [
                        {
                            "internalType": "uint256",
                            "name": "weight",
                            "type": "uint256"
                        },
                        {
                            "internalType": "bool",
                            "name": "voted",
                            "type": "bool"
                        },
                        {
                            "internalType": "address",
                            "name": "delegate",
                            "type": "address"
                        },
                        {
                            "internalType": "uint256",
                            "name": "vote",
                            "type": "uint256"
                        }
                    ],
                    "stateMutability": "view",
                    "type": "function"
                },
                {
                    "inputs": [],
                    "name": "winnerName",
                    "outputs": [
                        {
                            "internalType": "string",
                            "name": "winnerName_",
                            "type": "string"
                        }
                    ],
                    "stateMutability": "view",
                    "type": "function"
                },
                {
                    "inputs": [],
                    "name": "winningProposal",
                    "outputs": [
                        {
                            "internalType": "uint256",
                            "name": "winningProposal_",
                            "type": "uint256"
                        }
                    ],
                    "stateMutability": "view",
                    "type": "function"
                }
            ]
            const provider = new ethers.providers.Web3Provider(window.ethereum);
            contract = new ethers.Contract(daiAddress, abi, provider);

            //Calling First Proposal and displaying Name/Votes
            var proposal0 = contract.proposals(0);
            proposal0.then(function (result) {
                document.getElementById("proposal0name").innerHTML = result[0];
                document.getElementById("vote0count").innerHTML = result[1];
            });

            //Calling Second Proposal and displaying Name/Votes
            var proposal1 = contract.proposals(1);
            proposal1.then(function (result) {
                document.getElementById("proposal1name").innerHTML = result[0];
                document.getElementById("vote1count").innerHTML = result[1];
            });

            //Calling Third Proposal and displaying Name/Votes
            var proposal2 = contract.proposals(2);
            proposal2.then(function (result) {
                document.getElementById("proposal2name").innerHTML = result[0];
                document.getElementById("vote2count").innerHTML = result[1];
            });

            //Calling Fourth Proposal and displaying Name/Votes
            var proposal3 = contract.proposals(3);
            proposal3.then(function (result) {
                document.getElementById("proposal3name").innerHTML = result[0];
                document.getElementById("vote3count").innerHTML = result[1];
            });

            //Calling Fifth Proposal and displaying Name/Votes
            var proposal4 = contract.proposals(4);
            proposal4.then(function (result) {
                document.getElementById("proposal4name").innerHTML = result[0];
                document.getElementById("vote4count").innerHTML = result[1];
            });

            //Calling Sixth Proposal and displaying Name/Votes
            var proposal5 = contract.proposals(5);
            proposal5.then(function (result) {
                document.getElementById("proposal5name").innerHTML = result[0];
                document.getElementById("vote5count").innerHTML = result[1];
            });

            //Calling Seventh Proposal and displaying Name/Votes
            var proposal6 = contract.proposals(6);
            proposal6.then(function (result) {
                document.getElementById("proposal6name").innerHTML = result[0];
                document.getElementById("vote6count").innerHTML = result[1];
            });

            //Calling Eighth Proposal and displaying Name/Votes
            var proposal7 = contract.proposals(7);
            proposal7.then(function (result) {
                document.getElementById("proposal7name").innerHTML = result[0];
                document.getElementById("vote7count").innerHTML = result[1];
            });

            //Calling Nineth Proposal and displaying Name/Votes
            var proposal8 = contract.proposals(8);
            proposal8.then(function (result) {
                document.getElementById("proposal8name").innerHTML = result[0];
                document.getElementById("vote8count").innerHTML = result[1];
            });

            //Calling tenth Proposal and displaying Name/Votes
            var proposal9 = contract.proposals(9);
            proposal9.then(function (result) {
                document.getElementById("proposal9name").innerHTML = result[0];
                document.getElementById("vote9count").innerHTML = result[1];
            });

            //Calling eleventh Proposal and displaying Name/Votes
            var proposal10 = contract.proposals(10);
            proposal10.then(function (result) {
                document.getElementById("proposal10name").innerHTML = result[0];
                document.getElementById("vote10count").innerHTML = result[1];
            });

            //Calling Twevleth Proposal and displaying Name/Votes
            var proposal11 = contract.proposals(11);
            proposal11.then(function (result) {
                document.getElementById("proposal11name").innerHTML = result[0];
                document.getElementById("vote11count").innerHTML = result[1];
            });

            //Calling Thirteenth Proposal and displaying Name/Votes
            var proposal12 = contract.proposals(12);
            proposal12.then(function (result) {
                document.getElementById("proposal12name").innerHTML = result[0];
                document.getElementById("vote12count").innerHTML = result[1];
            });

        }

        function vote() {
            //Contract Address from Deploy Screen Remix -- Change to your contract
            const daiAddress = "0x146cEaa0a2d5c8ee542AAa3E97e0386C38353664";
            //ABI from Compile Screen RemixIDE
            abi = [
                {
                    "inputs": [
                        {
                            "internalType": "address",
                            "name": "to",
                            "type": "address"
                        }
                    ],
                    "name": "delegate",
                    "outputs": [],
                    "stateMutability": "nonpayable",
                    "type": "function"
                },
                {
                    "inputs": [
                        {
                            "internalType": "address",
                            "name": "voter",
                            "type": "address"
                        }
                    ],
                    "name": "giveRightToVote",
                    "outputs": [],
                    "stateMutability": "nonpayable",
                    "type": "function"
                },
                {
                    "inputs": [],
                    "stateMutability": "nonpayable",
                    "type": "constructor"
                },
                {
                    "inputs": [
                        {
                            "internalType": "uint256",
                            "name": "proposal",
                            "type": "uint256"
                        }
                    ],
                    "name": "vote",
                    "outputs": [],
                    "stateMutability": "nonpayable",
                    "type": "function"
                },
                {
                    "inputs": [],
                    "name": "chairperson",
                    "outputs": [
                        {
                            "internalType": "address",
                            "name": "",
                            "type": "address"
                        }
                    ],
                    "stateMutability": "view",
                    "type": "function"
                },
                {
                    "inputs": [
                        {
                            "internalType": "uint256",
                            "name": "",
                            "type": "uint256"
                        }
                    ],
                    "name": "proposals",
                    "outputs": [
                        {
                            "internalType": "string",
                            "name": "name",
                            "type": "string"
                        },
                        {
                            "internalType": "uint256",
                            "name": "voteCount",
                            "type": "uint256"
                        }
                    ],
                    "stateMutability": "view",
                    "type": "function"
                },
                {
                    "inputs": [
                        {
                            "internalType": "address",
                            "name": "",
                            "type": "address"
                        }
                    ],
                    "name": "voters",
                    "outputs": [
                        {
                            "internalType": "uint256",
                            "name": "weight",
                            "type": "uint256"
                        },
                        {
                            "internalType": "bool",
                            "name": "voted",
                            "type": "bool"
                        },
                        {
                            "internalType": "address",
                            "name": "delegate",
                            "type": "address"
                        },
                        {
                            "internalType": "uint256",
                            "name": "vote",
                            "type": "uint256"
                        }
                    ],
                    "stateMutability": "view",
                    "type": "function"
                },
                {
                    "inputs": [],
                    "name": "winnerName",
                    "outputs": [
                        {
                            "internalType": "string",
                            "name": "winnerName_",
                            "type": "string"
                        }
                    ],
                    "stateMutability": "view",
                    "type": "function"
                },
                {
                    "inputs": [],
                    "name": "winningProposal",
                    "outputs": [
                        {
                            "internalType": "uint256",
                            "name": "winningProposal_",
                            "type": "uint256"
                        }
                    ],
                    "stateMutability": "view",
                    "type": "function"
                }
            ]
            const provider = new ethers.providers.Web3Provider(window.ethereum);
            const signer = provider.getSigner();
            const contract = new ethers.Contract(daiAddress, abi, signer);

            var proposalval = document.getElementById("ProposalSelect").value;
            var castvote = contract.vote(proposalval);

            castvote.then(function (transaction) {
                document.getElementById("metamask").innerHTML = "result working";
                document.getElementById("metamask").innerHTML = transaction;
            });

        }


    </script>

    <h1 style="text-align:center; color: #ffffff; background-color: #266d85; width:32%; margin:auto">AIT VoteChain</h1>

    <div class="imgbox" style="width:32%; margin:auto">

        <img class="center-fit" src="votingimg.jpg" alt="Voting">

    </div>

    

    <div>
        <table class="table table-bordered table-striped" style="background-color: #ffffff; width: 80%; margin: auto; margin-top: 2%" >
            <thead>
                <tr>
                    <th style="width:40%">Presidential Candidates</th>
                    <th style="width:40%">Vote Count</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td id="proposal0name"></td>
                    <td id="vote0count"></td>
                </tr>
                <tr>
                    <td id="proposal1name"></td>
                    <td id="vote1count"></td>
                </tr>
                <tr>
                    <td id="proposal2name"></td>
                    <td id="vote2count"></td>
                </tr>
                <tr>
                    <td id="proposal3name"></td>
                    <td id="vote3count"></td>
                </tr>
                <tr>
                    <td id="proposal4name"></td>
                    <td id="vote4count"></td>
                </tr>
                <tr>
                    <td id="proposal5name"></td>
                    <td id="vote5count"></td>
                </tr>
                <tr>
                    <td id="proposal6name"></td>
                    <td id="vote6count"></td>
                </tr>
                <tr>
                    <td id="proposal7name"></td>
                    <td id="vote7count"></td>
                </tr>
                <tr>
                    <td id="proposal8name"></td>
                    <td id="vote8count"></td>
                </tr>
                <tr>
                    <td id="proposal9name"></td>
                    <td id="vote9count"></td>
                </tr>
                <tr>
                    <td id="proposal10name"></td>
                    <td id="vote10count"></td>
                </tr>
                <tr>
                    <td id="proposal11name"></td>
                    <td id="vote11count"></td>
                </tr>
                <tr>
                    <td id="proposal12name"></td>
                    <td id="vote12count"></td>
                </tr>
                <tr>
                    <td id="proposal13name"></td>
                    <td id="vote13count"></td>
                </tr>
            </tbody>
        </table>
    </div>

    <div style="background-color:#266d85; width:80%; margin:auto; margin-top:2%">
        <select id="ProposalSelect" style=" margin:auto; margin-left:35%">
            <option value="-1">--Select a Candidate to vote for --</option>
            <option value="0">Jo Jorgensen</option>
            <option value="1">Kanye West</option>
            <option value="2">Brock Pierce</option>
            <option value="3">Brian Carroll</option>
            <option value="4">Howie Hawkins</option>
            <option value="5">C.L. Gammon</option>
            <option value="6">Phil Collins</option>
            <option value="7">Gloria La Riva</option>
            <option value="8">John Richard Myers</option>
            <option value="9">Don Blankenship</option>
            <option value="10">Joseph R. Biden</option>
            <option value="11">Roque De La Fuente</option>
            <option value="12">Donald J. Trump</option>
        </select>
        <input style="margin:auto; background-color:#30b0b7" id="Button1" type="button" onclick="vote()" class="btn btn-primary" value="Vote!" />
    </div>
</body>
</html>